(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"+W90":function(t,i,e){},"27My":function(t,i,e){"use strict";e.r(i);var n=e("omC7"),a=e.n(n),o=e("cLjf"),p=e.n(o),r=e("hDQ3"),c=e.n(r),s=(e("aEPb"),e("jD4v")),d=(e("gJGO"),e("iLNi")),u=(e("uErz"),e("ogYY")),l=(e("ul/Q"),e("8DuP")),_=(e("CqKt"),e("FLOZ")),m=(e("XkPB"),e("cpGq")),g=e("2NsV"),h={name:"script-list",components:{ATable:m.a,ARangePicker:_.a.RangePicker,AButton:l.a,ATextarea:u.a.TextArea,AModal:d.a,AInput:u.a,AInputSearch:u.a.Search,ATransfer:s.a},data:function(){return{scripGroup:g,loading:!0,isEditUpLoadShow:!1,isAddUpLoadShow:!1,isUpLoadShow:!1,isScriptContent:!1,editDescribe:null,describe:"",search_key:null,script_name:null,scriptData:[],add_script_group_name:null,edit_module_group_name:"",linkScript:[],script_group_name:null,scriptDataList:[],pagination:{total:0,current:1,pageSize:10,onChange:this.pageChange},data:[]}},methods:{handleChange:function(t,i,e){this.linkScript=t,"left"===i&&this.$fetch.delete_module_group_map({module_id_list:e.toString(),module_group_id:this.module_group_id}).then(function(t){})},getScriptList:function(){var a=this;return c()(p.a.mark(function t(){var i,e,n;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.scriptData=[],t.next=3,a.$storage.get("admin_user_info");case 3:i=t.sent,e=i.user_id,n={user_id:e,page_no:1,length:1e6},a.$fetch.query_module(n).then(function(t){t.data_0.forEach(function(t){a.scriptData.push({key:t.module_id.toString(),title:t.module_name})}),a.loading=!1}).then(function(){a.loading=!1});case 7:case"end":return t.stop()}},t,a)}))()},uploadEditScriptConfigAction:function(t){this.module_group_id=t.module_group_id,this.edit_module_group_name=t.module_group_name,this.isEditUpLoadShow=!0},uploadEditScriptCancelAction:function(){this.isEditUpLoadShow=!1,this.script_group_name=""},uploadAddScriptCancelAction:function(){this.isAddUpLoadShow=!1,this.add_script_group_name=""},uploadEditcriptConfigAction:function(){var i=this;if(!this.edit_module_group_name)return this.$message.error("请输入模块组名称"),!1;this.$fetch.add_module_group({module_group_id:this.module_group_id,module_group_name:this.edit_module_group_name}).then(function(t){i.isEditUpLoadShow=!1,i.getList()})},uploadAddcriptConfigAction:function(){var i=this;if(!this.add_script_group_name)return this.$message.error("请输入模块组名称"),!1;this.$fetch.add_module_group({module_group_name:this.add_script_group_name}).then(function(t){i.isAddUpLoadShow=!1,i.add_script_group_name="",i.getList()})},uploadScriptCancelAction:function(){this.isUpLoadShow=!1},viewScriptContentAction:function(t){var i=this;this.linkScript=[],this.module_group_id=t.module_group_id,this.$fetch.query_module_by_group_id({module_group_id:t.module_group_id}).then(function(t){i.scriptDataList=JSON.parse(a()(i.scriptData)),i.linkScript=t.data_0.map(function(t){return t.module_id.toString()}),i.isScriptContent=!0}).catch(function(t){20===t.error_code?(i.scriptDataList=JSON.parse(a()(i.scriptData)),i.isScriptContent=!0,i.linkScript=[]):i.$message.error(t.error_message)})},contentScriptCancelAction:function(){this.isScriptContent=!1},bindingScriptconfigAction:function(){var i=this;this.$fetch.add_module_group_map({module_group_id:this.module_group_id,module_id_list:this.linkScript.toString()}).then(function(t){i.isScriptContent=!1})},deleteScriptAction:function(t){var i=this;this.$confirm({title:"删除脚本组",okText:"确定",cancelText:"取消",content:"您确定要删除该脚本组吗",onOk:function(){i.$fetch.delete_module_group({module_group_id:t.module_group_id}).then(function(t){i.getList()})},onCancel:function(){}})},onSearch:function(){this.getList()},pageChange:function(t){this.pagination.current=t,this.getList()},getList:function(){var u=this;return c()(p.a.mark(function t(){var i,e,n,a,o,r,c,s,d;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u.loading=!0,i=u.pagination,e=i.current,n=i.pageSize,t.next=4,u.$storage.get("admin_user_info");case 4:return a=t.sent,o=a.user_id,r={user_id:o,page_no:e,length:n,module_group_name:u.search_key},t.next=9,u.$fetch.query_module_group(r).catch(function(){u.loading=!1});case 9:c=t.sent,s=c.data_0,d=c.data_1,u.data=s||[],u.pagination.total=d?d.count:0,u.loading=!1;case 15:case"end":return t.stop()}},t,u)}))()}},created:function(){this.getList(),this.getScriptList()}},f=(e("EKBN"),e("ZpG+")),S=Object(f.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"script-list-group"},[n("div",{staticClass:"script-list-header"},[n("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入模块组名称"},on:{search:e.onSearch},model:{value:e.search_key,callback:function(t){e.search_key=t},expression:"search_key"}}),n("a-button",{attrs:{type:"primary"},on:{click:function(){e.isAddUpLoadShow=!0}}},[e._v("新增")])],1),n("div",{staticClass:"script-list-content"},[n("a-table",{attrs:{columns:e.scripGroup,rowKey:"module_group_id",dataSource:e.data,pagination:e.pagination,loading:e.loading},scopedSlots:e._u([{key:"created_time",fn:function(t){return n("span",{},[e._v(e._s(e._f("formatDate")(t)))])}},{key:"updated_time",fn:function(t){return n("span",{},[e._v(e._s(e._f("formatDate")(t)))])}},{key:"action",fn:function(t,i){return[n("a-button",{staticClass:"script-btn",attrs:{type:"primary"},on:{click:function(){return e.uploadEditScriptConfigAction(i)}}},[e._v("编辑")]),n("a-button",{staticClass:"script-btn",attrs:{type:"primary"},on:{click:function(){return e.viewScriptContentAction(i)}}},[e._v("绑定分组")]),n("a-button",{staticClass:"script-btn",attrs:{type:"danger"},on:{click:function(){return e.deleteScriptAction(i)}}},[e._v("删除")])]}}])})],1),n("a-modal",{attrs:{title:"新增模块组",visible:e.isAddUpLoadShow},on:{cancel:e.uploadAddScriptCancelAction}},[n("template",{slot:"footer"},[n("a-button",{on:{click:e.uploadAddScriptCancelAction}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.uploadAddcriptConfigAction}},[e._v("确定")])],1),n("a-form",[n("div",{staticClass:"dialog-content"},[n("div",{staticClass:"content-inner"},[n("span",{staticClass:"label-inner label-inner-first label-inner-first-name"},[e._v("模块组名称")]),n("a-input",{attrs:{placeholder:"模块组名称"},model:{value:e.add_script_group_name,callback:function(t){e.add_script_group_name=t},expression:"add_script_group_name"}})],1)])])],2),n("a-modal",{attrs:{title:"编辑模块组",visible:e.isEditUpLoadShow},on:{cancel:e.uploadEditScriptCancelAction}},[n("template",{slot:"footer"},[n("a-button",{on:{click:e.uploadEditScriptCancelAction}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.uploadEditcriptConfigAction}},[e._v("确定")])],1),n("a-form",[n("div",{staticClass:"dialog-content"},[n("div",{staticClass:"content-inner"},[n("span",{staticClass:"label-inner label-inner-first label-inner-first-name"},[e._v("模块组名称")]),n("a-input",{attrs:{placeholder:"模块组名称"},model:{value:e.edit_module_group_name,callback:function(t){e.edit_module_group_name=t},expression:"edit_module_group_name"}})],1)])])],2),n("a-modal",{attrs:{width:"700px",title:"绑定模块",visible:e.isScriptContent},on:{cancel:e.contentScriptCancelAction}},[n("template",{slot:"footer"},[n("a-button",{on:{click:e.contentScriptCancelAction}},[e._v("取消")]),n("a-button",{attrs:{type:"primary"},on:{click:e.bindingScriptconfigAction}},[e._v("确定绑定")])],1),n("div",{staticClass:"dialog-content"},[n("a-transfer",{attrs:{dataSource:e.scriptDataList,locale:{itemUnit:"项",itemsUnit:"项"},titles:["未关联的","已关联的"],targetKeys:e.linkScript,render:function(t){return t.title},listStyle:{width:"300px",height:"300px"}},on:{change:e.handleChange}})],1)],2)],1)},[],!1,null,null,null);i.default=S.exports},"2NsV":function(t){t.exports=JSON.parse('[{"key":"module_group_name","title":"模块组名","dataIndex":"module_group_name"},{"key":"created_time","title":"添加时间","dataIndex":"created_time","scopedSlots":{"customRender":"created_time"}},{"key":"updated_time","title":"更新时间","dataIndex":"updated_time","scopedSlots":{"customRender":"updated_time"}},{"key":"action","title":"操作","dataIndex":"action","scopedSlots":{"customRender":"action"}}]')},EKBN:function(t,i,e){"use strict";var n=e("+W90");e.n(n).a}}]);